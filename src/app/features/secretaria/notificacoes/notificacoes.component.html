<div class="notificacoes-container">
  <h2><mat-icon>notifications</mat-icon> Notificações</h2>

  <div class="toolbar">
    <button
      class="btn-marcar"
      (click)="marcarTodasComoLidas()"
      [disabled]="!notificacoes.length"
    >
      <mat-icon>done_all</mat-icon>
      Ler todas as notificações
    </button>

    <div class="paginacao">
      <button
        (click)="anterior()"
        [disabled]="page <= 1"
        aria-label="Página anterior"
      >
        <span class="arrow arrow-left">‹</span>
      </button>

      <span>Página {{ page }} / {{ totalPages }}</span>

      <button
        (click)="proxima()"
        [disabled]="page >= totalPages"
        aria-label="Próxima página"
      >
        <span class="arrow arrow-right">›</span>
      </button>
    </div>
  </div>

  <!-- LISTA -->
  <ng-container *ngIf="!carregando && !erro">
    <div class="lista">
      <div
        *ngFor="let notificacao of notificacoes"
        class="notificacao"
        [class.lida]="notificacao.lida"
        (click)="abrirNotificacao(notificacao)"
        tabindex="0"
        role="button"
        (keydown.enter)="abrirNotificacao(notificacao)"
        (keydown.space)="abrirNotificacao(notificacao); $event.preventDefault()"
        [attr.aria-label]="'Abrir notificação: ' + notificacao.tipo"
      >
        <p class="tipo">{{ notificacao.tipo }}</p>
        <p class="mensagem">
          <strong>{{ notificacao.mensagem }}</strong>
        </p>
        <p class="data">{{ notificacao.data }} às {{ notificacao.hora }}</p>
      </div>
    </div>

    <p *ngIf="!notificacoes.length" class="vazio">Sem notificações.</p>
  </ng-container>

  <!-- Modal -->
  <div
    class="modal"
    *ngIf="notificacaoAberta"
    (click)="fecharModal()"
    role="dialog"
    aria-modal="true"
    aria-labelledby="notificacaoTitulo"
  >
    <div class="modal-conteudo" (click)="$event.stopPropagation()" tabindex="0">
      <button class="fechar" (click)="fecharModal()" aria-label="Fechar">
        <mat-icon>close</mat-icon>
      </button>

      <h3 id="notificacaoTitulo">{{ notificacaoAberta.tipo }}</h3>

      <p class="mensagem">
        <strong>{{ notificacaoAberta.mensagem }}</strong>
      </p>

      <small class="data">
        {{ notificacaoAberta.data }} às {{ notificacaoAberta.hora }}
      </small>
    </div>
  </div>
</div>
